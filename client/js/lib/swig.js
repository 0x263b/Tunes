(function(){var b,a="{{ a }}";0===a.split(/(\{\{.*?\}\})/).length&&(b=function(a,c,d){function l(){var a=1;for(a;arguments.length-2>a;a+=1)void 0===arguments[a]&&(i[a]=void 0)}if("[object RegExp]"!==Object.prototype.toString.call(c))return b._nativeSplit.call(a,c,d);var h,i,j,k,e=[],f=0,g=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.sticky?"y":"");if(c=RegExp(c.source,g+"g"),a=""+a,b._compliantExecNpcg||(h=RegExp("^"+c.source+"$(?!\\s)",g)),void 0===d||0>d)d=1/0;else if(d=Math.floor(+d),!d)return[];for(i=c.exec(a);i&&(j=i.index+i[0].length,!(j>f&&(e.push(a.slice(f,i.index)),!b._compliantExecNpcg&&i.length>1&&i[0].replace(h,l),i.length>1&&i.index<a.length&&Array.prototype.push.apply(e,i.slice(1)),k=i[0].length,f=j,e.length>=d)));)c.lastIndex===i.index&&(c.lastIndex+=1),i=c.exec(a);return f===a.length?(k||!c.test(""))&&e.push(""):e.push(a.slice(f)),e.length>d?e.slice(0,d):e},b._compliantExecNpcg=void 0===/()??/.exec("")[1],b._nativeSplit=String.prototype.split,String.prototype.split=function(a,c){return b(this,a,c)})})(),swig=function(){var a={},b={},c={},d={},e={},f={};return function(a){function i(a){return{render:function(){return"<pre>"+a.stack+"</pre>"}}}function j(a){return Function("_context","_parents","_filters","_","_ext",["_parents = _parents ? _parents.slice() : [];","_context = _context || {};","var j = _parents.length,",'  _output = "",',"  _this = this;","while (j--) {","   if (_parents[j] === this.id) {",'     return "Circular import of template " + this.id + " in " + _parents[_parents.length-1];',"   }","}","_parents.push(this.id);",a,"return _output;"].join(""))}function k(b,c){var f,h,k,d={compileFile:a.compileFile,blocks:{},type:e.TEMPLATE,id:c};if(g.allowErrors)f=e.parse.call(d,b,g.tags,g.autoescape);else try{f=e.parse.call(d,b,g.tags,g.autoescape)}catch(l){return new i(l)}return d.tokens=f,h=e.compile.call(d),k=h!==!1?j(h):function(a,b,c,g,i){d.tokens=f,h=e.compile.call(d,"",a);var k=j(h);return k.call(this,a,b,c,g,i)},d.render=function(a,b){if(g.allowErrors)return k.call(this,a,b,g.filters,_,g.extensions);try{return k.call(this,a,b,g.filters,_,g.extensions)}catch(c){return new i(c)}},d}function l(a,b){var c=b.filename||a;return g.cache||b.cache?(h.hasOwnProperty(c)||(h[c]=k(a,c)),h[c]):k(a,c)}var d={allowErrors:!1,autoescape:!0,cache:!0,encoding:"utf8",filters:c,root:"/",tags:f,extensions:{},tzOffset:0},g=_.extend({},d),h={};a.init=function(a){h={},g=_.extend({},d,a),g.filters=_.extend(c,a.filters),g.tags=_.extend(f,a.tags),b.defaultTZOffset=g.tzOffset},a.compileFile=function(a,b){var c,e;if(g.cache&&h.hasOwnProperty(a))return h[a];if("undefined"!=typeof window)throw new i({stack:"You must pre-compile all templates in-browser. Use `swig.compile(template);`."});if(e=function(){var b,e,f;if(e=function(e){var g,f=/^\//.test(a)||/^.:/.test(a)?a:e+"/"+a;try{g=fs.readFileSync(f,d.encoding),c=l(g,{filename:a})}catch(h){b=h}},"string"==typeof g.root&&e(g.root),g.root instanceof Array)for(f=0;void 0===c&&g.root.length>f;)e(g.root[f]),f+=1;if(void 0===c)throw b},g.allowErrors||b)e();else try{e()}catch(f){c=new i(f)}return c},a.compile=function(a,b){var c=l(a,b||{});return function(a,b){return c.render(a,b)}}}(a),function(a){function d(a){return a.replace(/^\s+|\s+$/g,"")}function f(a){var b=[],c="",d=0;for(d;a.length>d;d+=1)!a[d]||a[d].charAt(0)===a[d].charAt(a[d].length-1)||0!==a[d].indexOf('"')&&0!==a[d].indexOf("'")?"."===a[d]&&c?c+=".":a[d].indexOf('"')===a[d].length-1||a[d].indexOf("'")===a[d].length-1?(c+=a[d],b.push(c),c=""):b.push(a[d]):c=a[d];return _.compact(b)}function g(b,c){if(_.isArray(b))return"(true)";if(b=b.replace(/^this/,"_this.__currentContext"),a.isLiteral(b))return"(true)";var d=b.split(/(\.|\[|\])/),e="",g=[],h=!1,i=!1;return"string"==typeof c&&c.length&&d.unshift(c),d=_.reject(d,function(a){return""===a}),d=f(d),_.each(d,function(b){if("."===b)return i=!0,void 0;if("["===b)return h=!0,void 0;if("]"===b)return h=!1,void 0;if(e)if(h)if(a.isStringLiteral(b))e+="["+b+"]";else{if(i)return g[g.length-1]=_.last(g).replace(/\] !== "undefined"$/,"_"+b+'] !== "undefined"'),e=e.replace(/\]$/,"_"+b+"]"),void 0;e+="[___"+b+"]"}else e+="."+b;else e=b;i=!1,g.push("typeof "+e+' !== "undefined"')}),"("+g.join(" && ")+")"}var b=/^(Array|ArrayBuffer|Boolean|Date|Error|eval|EvalError|Function|Infinity|Iterator|JSON|Math|Namespace|NaN|Number|Object|QName|RangeError|ReferenceError|RegExp|StopIteration|String|SyntaxError|TypeError|undefined|uneval|URIError|XML|XMLList|break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|this|throw|try|typeof|var|void|while|with)(?=(\.|$))/;a.isStringLiteral=function(a){if("string"!=typeof a)return!1;var d,b=a.substring(0,1),c=a.charAt(a.length-1,1);if(b===c&&("'"===b||'"'===b)){if(d=a.substr(1,a.length-2).split("").reverse().join(""),"'"===b&&/'(?!\\)/.test(d)||'"'===c&&/"(?!\\)/.test(d))throw Error("Invalid string literal. Unescaped quote ("+a[0]+") found.");return!0}return!1},a.isLiteral=function(b){var c=!1;return/^\d+([.]\d+)?$/.test(b)?c=!0:a.isStringLiteral(b)&&(c=!0),c},a.isValidName=function(a){return"string"==typeof a&&"__"!==a.substr(0,2)&&/^([$A-Za-z_]+[$A-Za-z_0-9]*)(\.?([$A-Za-z_]+[$A-Za-z_0-9]*))*$/.test(a)&&!b.test(a)},a.isValidShortName=function(a){return"__"!==a.substr(0,2)&&/^[$A-Za-z_]+[$A-Za-z_0-9]*$/.test(a)&&!b.test(a)},a.isValidBlockName=function(a){return/^[A-Za-z]+[A-Za-z_0-9]*$/.test(a)},a.stripWhitespace=d,a.check=g,a.escapeVarName=function(b,c){if(_.isArray(b))return _.each(b,function(d,e){b[e]=a.escapeVarName(d,c)}),b;if(b=b.replace(/^this/,"_this.__currentContext"),a.isLiteral(b))return b;"string"==typeof c&&c.length&&(b=c+"."+b);var d="",e=b.split(/(\.|\[|\])/),g=!1,h=!1;return e=_.reject(e,function(a){return""===a}),e=f(e),_.each(e,function(b){return"."===b?(h=!0,void 0):"["===b?(g=!0,void 0):"]"===b?(g=!1,void 0):(d?g?a.isStringLiteral(b)?d+="["+b+"]":h?d=d.replace(/\]$/,"_"+b+"]"):d+="[___"+b+"]":d+="."+b:d=b,h=!1,void 0)}),d},a.wrapMethod=function(b,c,d){var g,f="(function () {\n";return b=b||'""',c?(g=c.args.split(","),g=_.map(g,function(b){var c,d=b.replace(/^\s+|\s+$/g,"");try{c="__"+e.parseVariable(d).name.replace(/\W/g,"_")}catch(g){return b}return a.isValidName(d)?(f+=a.setVar(c,e.parseVariable(d)),c):b}),g=g&&g.length?g.join(","):'""',f+="return ",f+=d?d+'["':"",f+=c.name,f+=d?'"]':"",f+=".call(this",f+=g.length?", "+g:"",f+=");\n",f+"})()"):b},a.wrapFilter=function(b,d){var e="",f="";if(b=b||'""',!d)return b;if(!c.hasOwnProperty(d.name))throw Error('Filter "'+d.name+'" not found');return f=d.args?b+", "+d.args:b,e+=a.wrapMethod(b,{name:d.name,args:f},"_filters")},a.wrapFilters=function(b,c,d,e){var f=a.escapeVarName(b,d);return c&&c.length>0&&_.each(c,function(b){switch(b.name){case"raw":return e=!1,void 0;case"e":case"escape":return e=b.args||e,void 0;default:f=a.wrapFilter(f,b,"_filters")}}),f=f||'""',e&&(f="_filters.escape.call(this, "+f+", "+e+")"),f},a.setVar=function(b,c){var e,f,h,d="";return/\[/.test(c.name)&&(e=c.name.split(/(\[|\])/),f=[],h=!1,_.each(e,function(b){return""!==b?"["===b?(h=!0,void 0):"]"===b?(h=!1,void 0):(h&&!a.isStringLiteral(b)&&(d+=a.setVar("___"+b.replace(/\W/g,"_"),{name:b,filters:[],escape:!0})),void 0):void 0})),d+="var "+b+' = "";\n'+"if ("+g(c.name,"_context")+") {\n"+"  "+b+" = "+a.wrapFilters(c.name,c.filters,"_context",c.escape)+";\n"+"} else if ("+g(c.name)+") {\n"+"  "+b+" = "+a.wrapFilters(c.name,c.filters,null,c.escape)+";\n"+"}\n",c.filters.length&&(d+=" else if (true) {\n",d+="  "+b+" = "+a.wrapFilters("",c.filters,null,c.escape)+";\n",d+="}\n"),d},a.parseIfArgs=function(b,c){var i,j,d=["==","<",">","!=","<=",">=","===","!==","&&","||","in","and","or","mod","%"],e="Bad if-syntax in `{% if "+b.join(" ")+" %}...",f=/^\(+/,g=/\)+$/,h=[],k=0;if(_.each(b,function(b,l){var o,m=0,n=0;if(f.test(b))for(n=b.match(f)[0].length,k+=n,b=b.replace(f,"");n;)n-=1,h.push({type:"separator",value:"("});if((/^\![^=]/.test(b)||"not"===b)&&(b="not"===b?"":b.substr(1),h.push({type:"operator",value:"!"})),g.test(b)&&-1===b.indexOf("(")){if(!k)throw Error(e);m=b.match(g)[0].length,b=b.replace(g,""),k-=m}if("in"===b)j=h.pop(),i="inindex";else if(-1!==_.indexOf(d,b)){if("operator"===i)throw Error(e);b=b.replace("and","&&").replace("or","||").replace("mod","%"),h.push({value:b}),i="operator"}else if(""!==b){if("value"===i)throw Error(e);o=c.parseVariable(b),"inindex"===i?(h.push({preout:j.preout+a.setVar("__op"+l,o),value:"(((_.isArray(__op"+l+") || typeof __op"+l+' === "string") && _.indexOf(__op'+l+", "+j.value+") !== -1) || (typeof __op"+l+' === "object" && '+j.value+" in __op"+l+"))"}),j=null):h.push({preout:a.setVar("__op"+l,o),value:"__op"+l}),i="value"}for(;m;)m-=1,h.push({type:"separator",value:")"})}),k>0)throw Error(e);return h}}(d),function(a){var b={full:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},c={full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],alt:{"-1":"Yesterday",0:"Today",1:"Tomorrow"}};a.defaultTZOffset=0,a.DateZ=function(){function e(a){return 10>a?"0"+a:a}function f(){var a=e(Math.floor(Math.abs(c.timezoneOffset)/60)),b=e(Math.abs(c.timezoneOffset)-60*a),d=0>c.timezoneOffset?"+":"-",f=void 0===c.tzAbbreviation?"":" ("+c.tzAbbreviation+")";return"GMT"+d+a+b+f}var b={"default":["getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","toISOString","toGMTString","toUTCString","valueOf","getTime"],z:["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getYear","toDateString","toLocaleDateString","toLocaleTimeString"],string:["toLocaleString","toString","toTimeString"],zSet:["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setYear"],set:["setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds"],"static":["UTC","parse"]},c=this;c.date=c.dateZ=arguments.length>1?new Date(Date.UTC.apply(Date,arguments)+6e4*(new Date).getTimezoneOffset()):1===arguments.length?new Date(new Date(arguments["0"])):new Date,c.timezoneOffset=c.dateZ.getTimezoneOffset(),_.each(b.z,function(a){c[a]=function(){return c.dateZ[a]()}}),_.each(b.string,function(a){c[a]=function(){return c.dateZ[a].apply(c.dateZ,[]).replace(/GMT[+\-]\\d{4} \\(([a-zA-Z]{3,4})\\)/,f())}}),_.each(b["default"],function(a){c[a]=function(){return c.date[a]()}}),_.each(b["static"],function(a){c[a]=function(){return Date[a].apply(Date,arguments)}}),_.each(b.zSet,function(a){c[a]=function(){return c.dateZ[a].apply(c.dateZ,arguments),c.date=new Date(c.dateZ.getTime()-6e4*c.dateZ.getTimezoneOffset()+6e4*c.timezoneOffset),c}}),_.each(b.set,function(a){c[a]=function(){return c.date[a].apply(c.date,arguments),c.dateZ=new Date(c.date.getTime()+6e4*c.date.getTimezoneOffset()-6e4*c.timezoneOffset),c}}),a.defaultTZOffset&&this.setTimezoneOffset(a.defaultTZOffset)},a.DateZ.prototype={getTimezoneOffset:function(){return this.timezoneOffset},setTimezoneOffset:function(a,b){return this.timezoneOffset=a,b&&(this.tzAbbreviation=b),this.dateZ=new Date(this.date.getTime()+6e4*this.date.getTimezoneOffset()-6e4*this.timezoneOffset),this}},a.d=function(a){return(10>a.getDate()?"0":"")+a.getDate()},a.D=function(a){return c.abbr[a.getDay()]},a.j=function(a){return a.getDate()},a.l=function(a){return c.full[a.getDay()]},a.N=function(a){var b=a.getDay();return b>=1?b+1:7},a.S=function(a){var b=a.getDate();return 1===b%10&&11!==b?"st":2===b%10&&12!==b?"nd":3===b%10&&13!==b?"rd":"th"},a.w=function(a){return a.getDay()},a.z=function(b,c,d){var e=b.getFullYear(),f=new a.DateZ(e,b.getMonth(),b.getDate(),12,0,0),g=new a.DateZ(e,0,1,12,0,0);return f.setTimezoneOffset(c,d),g.setTimezoneOffset(c,d),Math.round((f-g)/864e5)},a.W=function(a){var d,b=new Date(a.valueOf()),c=(a.getDay()+6)%7;return b.setDate(b.getDate()-c+3),d=b.valueOf(),b.setMonth(0,1),4!==b.getDay()&&b.setMonth(0,1+(4-b.getDay()+7)%7),1+Math.ceil((d-b)/6048e5)},a.F=function(a){return b.full[a.getMonth()]},a.m=function(a){return(9>a.getMonth()?"0":"")+(a.getMonth()+1)},a.M=function(a){return b.abbr[a.getMonth()]},a.n=function(a){return a.getMonth()+1},a.t=function(a){return 32-new Date(a.getFullYear(),a.getMonth(),32).getDate()},a.L=function(a){return 29===new Date(a.getFullYear(),1,29).getDate()},a.o=function(a){var b=new Date(a.valueOf());return b.setDate(b.getDate()-(a.getDay()+6)%7+3),b.getFullYear()},a.Y=function(a){return a.getFullYear()},a.y=function(a){return(""+a.getFullYear()).substr(2)},a.a=function(a){return 12>a.getHours()?"am":"pm"},a.A=function(a){return 12>a.getHours()?"AM":"PM"},a.B=function(a){var c,b=a.getUTCHours();return b=23===b?0:b+1,c=Math.abs((60*(60*b+a.getUTCMinutes())+a.getUTCSeconds())/86.4).toFixed(0),"000".concat(c).slice(c.length)},a.g=function(a){var b=a.getHours();return 0===b?12:b>12?b-12:b},a.G=function(a){return a.getHours()},a.h=function(a){var b=a.getHours();return(10>b||b>12&&22>b?"0":"")+(12>b?b:b-12)},a.H=function(a){var b=a.getHours();return(10>b?"0":"")+b},a.i=function(a){var b=a.getMinutes();return(10>b?"0":"")+b},a.s=function(a){var b=a.getSeconds();return(10>b?"0":"")+b},a.O=function(a){var b=a.getTimezoneOffset();return(0>b?"-":"+")+(10>b/60?"0":"")+b/60+"00"},a.Z=function(a){return 60*a.getTimezoneOffset()},a.c=function(a){return a.toISOString()},a.r=function(a){return a.toUTCString()},a.U=function(a){return a.getTime()/1e3}}(b),function(a){a.add=function(a,b){return _.isArray(a)&&_.isArray(b)?a.concat(b):"object"==typeof a&&"object"==typeof b?_.extend(a,b):_.isNumber(a)&&_.isNumber(b)?a+b:a+b},a.addslashes=function(b){return"object"==typeof b?(_.each(b,function(c,d){b[d]=a.addslashes(c)}),b):b.replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/\"/g,'\\"')},a.capitalize=function(b){return"object"==typeof b?(_.each(b,function(c,d){b[d]=a.capitalize(c)}),b):(""+b).charAt(0).toUpperCase()+(""+b).substr(1).toLowerCase()},a.date=function(a,c,d,e){var h,f=c.length,g=new b.DateZ(a),i=0,j="";for(d&&g.setTimezoneOffset(d,e),i;f>i;i+=1)h=c.charAt(i),j+=b.hasOwnProperty(h)?b[h](g,d,e):h;return j},a["default"]=function(a,b){return void 0===a||!a&&"number"!=typeof a?b:a},a.escape=a.e=function(a,b){if(b=b||"html","string"==typeof a){if("js"===b){var d,c=0,e="";for(a=a.replace(/\\/g,"\\u005C"),c;a.length>c;c+=1)d=a.charCodeAt(c),32>d?(d=d.toString(16).toUpperCase(),d=2>d.length?"0"+d:d,e+="\\u00"+d):e+=a[c];return e.replace(/&/g,"\\u0026").replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\'/g,"\\u0027").replace(/"/g,"\\u0022").replace(/\=/g,"\\u003D").replace(/-/g,"\\u002D").replace(/;/g,"\\u003B")}return a.replace(/&(?!amp;|lt;|gt;|quot;|#39;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}return a},a.first=function(a){return"object"!=typeof a||_.isArray(a)?"string"==typeof a?a.substr(0,1):_.first(a):""},a.join=function(a,b){if(_.isArray(a))return a.join(b);if("object"==typeof a){var c=[];return _.each(a,function(a){c.push(a)}),c.join(b)}return a},a.json_encode=function(a,b){return JSON.stringify(a,null,b||0)},a.last=function(a){return"object"!=typeof a||_.isArray(a)?"string"==typeof a?a.charAt(a.length-1):_.last(a):""},a.length=function(a){return"object"==typeof a?_.keys(a).length:a.length},a.lower=function(b){return"object"==typeof b?(_.each(b,function(c,d){b[d]=a.lower(c)}),b):(""+b).toLowerCase()},a.replace=function(a,b,c,d){var e=RegExp(b,d);return a.replace(e,c)},a.reverse=function(a){return _.isArray(a)?a.reverse():a},a.striptags=function(b){return"object"==typeof b?(_.each(b,function(c,d){b[d]=a.striptags(c)}),b):(""+b).replace(/(<([^>]+)>)/gi,"")},a.title=function(b){return"object"==typeof b?(_.each(b,function(c,d){b[d]=a.title(c)}),b):(""+b).replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},a.uniq=function(a){return _.uniq(a)},a.upper=function(b){return"object"==typeof b?(_.each(b,function(c,d){b[d]=a.upper(c)}),b):(""+b).toUpperCase()},a.url_encode=function(a){return encodeURIComponent(a)},a.url_decode=function(a){return decodeURIComponent(a)}}(c),function(a){function i(a){return d.stripWhitespace(a).match(/^[\w\.]+/)[0]}function j(a){return a.replace(/\\/g,"\\\\")}function k(a){return j(d.stripWhitespace(a).replace(/^[\w\.]+\(|\)$/g,""))}function l(a,b){for(var c=a.split(".");c.length;)b=b[c.splice(0,1)[0]];return b}function m(a,b){function h(a,c){for(var d=RegExp("\\"+c+"$"),e=a,f="";!d.test(f)&&b.length>e;)f+=" "+b[e],b[e]=null,e+=1;if(!d.test(f))throw Error("Malformed arguments "+f+" sent to tag.");return f.replace(/^ /,"")}b=_.map(b,j);var e,f,c=0,d=b.length,g=[];for(c;d>c;c+=1)if(e=b[c],null!==e&&!/^\s+$/.test(e))if(/^\"/.test(e)&&!/\"[\]\}]?$/.test(e)||/^\'/.test(e)&&!/\'[\]\}]?$/.test(e)||/^\{/.test(e)&&!/\}$/.test(e)||/^\[/.test(e)&&!/\]$/.test(e)){switch(e.substr(0,1)){case"'":f="'";break;case'"':f='"';break;case"[":f="]";break;case"{":f="}"}g.push(h(c,f))}else g.push(e);return g}function n(a,b){_.each(a.tokens,function(a){"block"===a.name&&(b[a.args[0]]=a,n(a,b))})}function o(a){var b;return a.parentBlock?b=a.parentBlock:a.parent&&(b=o(_.last(a.parent))),b}function p(a,b){var c,e,h=[];if(this.type===f){if(_.each(this.tokens,function(a,f){if(!e)if("extends"===a.name){if(c=a.args[0],!d.isStringLiteral(c)){if(!b)return e=!0,void 0;c='"'+l(c,b)+'"'}if(!d.isStringLiteral(c)||a.args.length>1)throw Error("Extends tag on line "+a.line+" accepts exactly one string literal as an argument.");if(f>0)throw Error('Extends tag must be the first tag in the template, but "extends" found on line '+a.line+".");a.template=this.compileFile(c.replace(/['"]/g,""),!0),this.parent=a.template,this.blocks=_.extend({},this.parent.blocks,this.blocks)}else if("block"===a.name){var j,i=a.args[0];if(!d.isValidBlockName(i)||1!==a.args.length)throw Error('Invalid block tag name "'+i+'" on line '+a.line+".");this.blocks[i]=a,n(a,this.blocks),this.parent&&(a.parentBlock=this.parent.blocks[i],j=_.indexOf(this.parent.tokens,this.parent.blocks[i]),j>=0&&(this.parent.tokens[j]=a))}else a.type===g&&h.push(a)},this),e)return!1;this.parent&&this.parent.tokens&&(this.tokens=h.concat(this.parent.tokens))}}var b=/^\{\{[^\r]*?\}\}$/,c=/^\{%[^\r]*?%\}$/,e=/^\{#[^\r]*?#\}$/,f=a.TEMPLATE=0,g=1,h=2;a.TOKEN_TYPES={TEMPLATE:f,LOGIC:g,VAR:h},a.parseVariable=function(a,b){if(!a)return{type:null,name:"",filters:[],escape:b};var c=[],d=a.replace(/^\{\{\s*|\s*\}\}$/g,"").split("|"),e=d.shift(),f=null;return/\(/.test(e)&&(f=k(e.replace(/^\w+\./,"")),e=i(e)),_.each(d,function(a,b){a&&(/^[\w\.]+\(/.test(a)||/\)$/.test(a))&&!/^[\w\.]+\([^\)]*\)$/.test(a)&&(d[b]+=d[b+1]?"|"+d[b+1]:"",d[b+1]=!1)}),d=_.without(d,!1),_.each(d,function(a){var b=i(a);/\(/.test(a)?c.push({name:b,args:k(a)}):c.push({name:b,args:""})}),{type:h,name:e,args:f,filters:c,escape:b}},a.parse=function(f,h,i){var r,s,t,x,j=d.stripWhitespace(f).split(/(\{%[^\r]*?%\}|\{\{.*?\}\}|\{#[^\r]*?#\})/),k=!!i,l=k,n=[[]],o=0,p=0,q=j.length,u=1,v=1,w=null,y=/^\{\% *raw *\%\}/,z=/\{\% *endraw *\%\}$/,A=!1,B=!1,C=!1,D=!1,E=!1;for(p;q>p;p+=1)if(r=j[p],v=u,w=r.match(/\n/g),B=!1,C=!1,D=!1,E=!1,w&&(u+=w.length),A===!1||z.test(r)){if(0!==r.length&&!e.test(r)){if(/^\s+$/.test(r))r=r.replace(/ +/," ").replace(/\n+/,"\n");else if(b.test(r))r=a.parseVariable(r,k);else if(c.test(r)){if(z.test(r)){r=A+r.replace(z,""),A=!1,n[o].push(r);continue}if(y.test(r)){A=r.replace(y,"");continue}if(s=r.replace(/^\{%\s*|\s*%\}$/g,"").split(" "),"-"===s[0]&&(C=!0,s.shift()),t=s.shift(),"-"===_.last(s)&&(B=!0,s.pop()),o>0&&/^end/.test(t)){if(x=_.last(n[n.length-2]),"end"+x.name===t){"autoescape"===x.name&&(k=l),x.strip.end=C,x.strip.after=B,n.pop(),o-=1;continue}throw Error('Expected end tag for "'+x.name+'", but found "'+t+'" at line '+u+".")}if(!h.hasOwnProperty(t))throw Error("Unknown logic tag at line "+u+': "'+t+'".');if("autoescape"===t&&(l=k,k=s.length&&"true"!==s[0]?!1:s.length>=2?s[1]:!0),r={type:g,line:v,name:t,compile:h[t],parent:_.uniq(n[n.length-2]||[]),strip:{before:C,after:B,start:!1,end:!1}},r.args=m(r,s),h[t].ends){r.strip.after=!1,r.strip.start=B,n[o].push(r),n.push(r.tokens=[]),o+=1;continue}}n[o].push(r)}}else A+=r;if(A!==!1)throw Error('Missing expected end tag for "raw" on line '+v+".");if(0!==o)throw x=_.last(n[n.length-2]),Error('Missing end tag for "'+x.name+'" that was opened on line '+x.line+".");return n[o]},a.compile=function q(b,c,e){var k,l,m,i="";return b=b||"",this.type===f&&(e=this),this.blocks||(this.blocks={}),p.call(this,b,c)===!1?!1:(_.each(this.tokens,function(f,n){var p,r,s,t,u;if("string"==typeof f)return t=this.tokens[n-1],u=this.tokens[n+1],t&&t.strip&&t.strip.after&&(f=f.replace(/^\s+/,"")),u&&u.strip&&u.strip.before&&(f=f.replace(/\s+$/,"")),i+='_output += "'+j(f).replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/"/g,'\\"')+'";\n';if("object"==typeof f&&(f.type===h&&(p=f.name.replace(/\W/g,"_"),r=d.isLiteral(p)?'["'+p+'"]':"."+p,s=f.args&&f.args.length?f.args:"",i+='if (typeof _context !== "undefined" && typeof _context'+r+' === "function") {\n',k=d.wrapMethod("",{name:p,args:s},"_context"),i+='  _output = (typeof _output === "undefined") ? '+k+": _output + "+k+";\n",d.isValidName(p)&&(i+="} else if (typeof "+p+' === "function") {\n',k=d.wrapMethod("",{name:p,args:s}),i+='  _output = (typeof _output === "undefined") ? '+k+": _output + "+k+";\n"),i+="} else {\n",i+=d.setVar("__"+p,f),i+='  _output = (typeof _output === "undefined") ? __'+p+": _output + __"+p+";\n",i+="}\n"),f.type===g))if("block"===f.name){if(l=f.args[0],!e.blocks.hasOwnProperty(l))throw Error('Unrecognized nested block.  Block "'+l+'" at line '+f.line+' of "'+e.id+'" is not in template block list.');i+=q.call(e.blocks[f.args[0]],b+"  ",c,e)}else if("parent"===f.name){if(m=o(f),!m)throw Error("No parent block found for parent tag at line "+f.line+".");i+=q.call(m,b+"  ",c)}else f.hasOwnProperty("compile")?(f.strip.start&&f.tokens.length&&"string"==typeof f.tokens[0]&&(f.tokens[0]=f.tokens[0].replace(/^\s+/,"")),f.strip.end&&f.tokens.length&&"string"==typeof _.last(f.tokens)&&(f.tokens[f.tokens.length-1]=_.last(f.tokens).replace(/\s+$/,"")),i+=f.compile(b+"  ",a)):i+=q.call(f,b+"  ",c)},this),i)}}(e),f.autoescape=function(){return module={},module.exports=function(a,b){return b.compile.apply(this,[a])},module.exports.ends=!0,module.exports}(),f.block=function(){return module={},module.exports={ends:!0},module.exports}(),f["else"]=function(){return module={},module.exports=function(a,b){var f,g,h,c=_.last(this.parent).name,e=_.clone(this.args);if("for"===c){if(e.length)throw Error('"else" tag cannot accept arguments in the "for" context.');return"} if (__loopLength === 0) {\n"}if("if"!==c)throw Error('Cannot call else tag outside of "if" or "for" context.');return f=e.shift(),g=d.parseIfArgs(e,b),h="",f?(h+="} else if (\n",h+="  (function () {\n",_.each(g,function(a){a.hasOwnProperty("preout")&&a.preout&&(h+=a.preout+"\n")}),h+="return (\n",_.each(g,function(a){h+=a.value+" "}),h+=");\n",h+="  })()\n",h+=") {\n"):a+"\n} else {\n"},module.exports}(),f["extends"]=function(){return module={},module.exports={},module.exports}(),f.filter=function(){return module={},module.exports=function(a,b){var c=_.clone(this.args),e=c.shift(),f=c.length?c.join(", "):"",g="(function () {\n";return g+='  var _output = "";\n',g+=b.compile.apply(this,[a+"  "])+"\n",g+="  return _output;\n",g+="})()\n","_output += "+d.wrapFilter(g.replace(/\n/g,""),{name:e,args:f})+";\n"},module.exports.ends=!0,module.exports}(),f["for"]=function(){return module={},module.exports=function(a,b){var i,c=_.clone(this.args),e=c[0],f=c[1],g=b.parseVariable(c[2]),h="";if(a=a||"",f!==void 0&&"in"!==f)throw Error('Invalid syntax in "for" tag');if(!d.isValidShortName(e))throw Error("Invalid arguments ("+e+') passed to "for" tag');if(!d.isValidName(g.name))throw Error("Invalid arguments ("+g.name+') passed to "for" tag');return e=d.escapeVarName(e),i='loop.index = __loopIndex + 1;\nloop.index0 = __loopIndex;\nloop.revindex = __loopLength - loop.index0;\nloop.revindex0 = loop.revindex - 1;\nloop.first = (__loopIndex === 0);\nloop.last = (__loopIndex === __loopLength - 1);\n_context["'+e+'"] = __loopIter[loop.key];\n'+b.compile.apply(this,[a+"   "]),h='(function () {\n  var loop = {}, __loopKey, __loopIndex = 0, __loopLength = 0, __keys = [],    __ctx_operand = _context["'+e+'"],\n'+"    loop_cycle = function() {\n"+"      var args = _.toArray(arguments), i = loop.index0 % args.length;\n"+"      return args[i];\n"+"    };\n"+d.setVar("__loopIter",g)+"  else {\n"+"    return;\n"+"  }\n"+"  if (_.isArray(__loopIter)) {\n"+"    __loopIndex = 0; __loopLength = __loopIter.length;\n"+"    for (; __loopIndex < __loopLength; __loopIndex += 1) {\n"+"       loop.key = __loopIndex;\n"+i+"    }\n"+'  } else if (typeof __loopIter === "object") {\n'+"    __keys = _.keys(__loopIter);\n"+"    __loopLength = __keys.length;\n"+"    __loopIndex = 0;\n"+"    for (; __loopIndex < __loopLength; __loopIndex += 1) {\n"+"       loop.key = __keys[__loopIndex];\n"+i+"    }\n"+"  }\n"+'  _context["'+e+'"] = __ctx_operand;\n'+"})();\n"},module.exports.ends=!0,module.exports}(),f["if"]=function(){return module={},module.exports=function(a,b){var c=_.clone(this.args),e=d.parseIfArgs(c,b),f="(function () {\n";return _.each(e,function(a){a.hasOwnProperty("preout")&&a.preout&&(f+=a.preout+"\n")}),f+="\nif (\n",_.each(e,function(a){f+=a.value+" "}),f+=") {\n",f+=b.compile.apply(this,[a+"  "]),f+="\n}\n",f+="})();\n"},module.exports.ends=!0,module.exports}(),f["import"]=function(){return module={},module.exports=function(a,b){3!==this.args.length;var c=_.clone(this.args),e=c[0],f=c[1],g=c[2],h="";if(!d.isLiteral(e)&&!d.isValidName(e))throw Error('Invalid attempt to import "'+e+'".');if("as"!==f)throw Error('Invalid syntax {% import "'+e+'" '+f+" "+g+" %}");return h+="_.extend(_context, (function () {\n",h+='var _context = {}, __ctx = {}, _output = "";\n'+d.setVar("__template",b.parseVariable(e))+"_this.compileFile(__template).render(__ctx, _parents);\n"+"_.each(__ctx, function (item, key) {\n"+'  if (typeof item === "function") {\n'+'    _context["'+g+'_" + key] = item;\n'+"  }\n"+"});\n"+"return _context;\n",h+="})());\n"},module.exports}(),f.include=function(){return module={},module.exports=function(a,b){var i,c=_.clone(this.args),e=c.shift(),f="_context",g=!1,h="";if(a=a||"",!d.isLiteral(e)&&!d.isValidName(e))throw Error("Invalid arguments passed to 'include' tag.");if(c.length){if("only"===_.last(c)&&(f="{}",c.pop()),c.length>1&&"ignore"===c[0]&"missing"===c[1]&&(c.shift(),c.shift(),g=!0),c.length&&"with"!==c[0])throw Error("Invalid arguments passed to 'include' tag.");if("with"===c[0]){if(c.shift(),!c.length)throw Error("Context for 'include' tag not provided, but expected after 'with' token.");i=c.shift(),f='_context["'+i+'"] || '+i}}return h="(function () {\n"+d.setVar("__template",b.parseVariable(e))+"\n"+"  var includeContext = "+f+";\n",g&&(h+="try {\n"),h+='  if (typeof __template === "string") {\n',h+="    _output += _this.compileFile(__template).render(includeContext, _parents);\n",h+="  }\n",g&&(h+="} catch (e) {}\n"),h+="})();\n"},module.exports}(),f.macro=function(){return module={},module.exports=function(a,b){var c=_.clone(this.args),d=c.shift(),e="",f="";return c.length&&(e=JSON.stringify(c).replace(/^\[|\'|\"|\]$/g,"")),f+="_context."+d+" = function ("+e+") {\n",f+='  var _output = "";\n',f+=b.compile.apply(this,[a+"  "]),f+="  return _output;\n",f+="};\n"},module.exports.ends=!0,module.exports}(),f.parent=function(){return module={},module.exports={},module.exports}(),f.raw=function(){return module={},module.exports={ends:!0},module.exports}(),f.set=function(){return module={},module.exports=function(a,b){var f,c=_.clone(this.args),e=d.escapeVarName(c.shift(),"_context");if("="!==c.shift())throw Error('Invalid token "'+c[1]+'" in {% set '+c[0]+' %}. Missing "=".');return f=c[0],d.isLiteral(f)||/^\{|^\[/.test(f)||"true"===f||"false"===f?" "+e+" = "+f+";":(f=b.parseVariable(f)," "+e+" = "+"(function () {\n"+"  var _output;\n"+b.compile.apply({tokens:[f]},[a])+"\n"+"  return _output;\n"+"})();\n")},module.exports}(),a}();
